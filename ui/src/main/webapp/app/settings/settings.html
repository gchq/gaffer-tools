<!--
  ~ Copyright 2017-2018 Crown Copyright
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<div layout="row" layout-padding>
    <div flex-offset-gt-sm="20" flex-gt-sm="60" flex="100">
        <div layout="column" flex>
            <h3>Settings</h3>
            <md-input-container>
                <label>Default result limit</label>
                <input type="number" step="1" ng-model="ctrl.resultLimit"
                       id="resultLimit" ng-blur="ctrl.updateResultLimit()">
            </md-input-container>

            <div ng-if="ctrl.hasOpOptions()">
                <h4>Default Operation Options</h4>

                <div layout="row"
                     ng-repeat="opOption in ctrl.defaultOpOptionsArray">
                    <md-input-container flex>
                        <label>Key</label>
                        <md-select name="opOptionKey"
                                   ng-model="opOption.key"
                                   required
                                   aria-label="operation option key picker"
                                   md-on-close="ctrl.updateDefaultOpOptions()">
                            <md-option ng-value="value"
                                       ng-repeat="(key, value) in ctrl.getOpOptionKeys(opOption)"
                                       aria-label="{{key}}">
                                <div class="md-body-2">{{key}}</div>
                            </md-option>
                        </md-select>
                        <div class="md-errors-spacer"></div>
                    </md-input-container>

                    <md-input-container flex>
                        <label>Value</label>
                        <input type="text"
                               ng-blur="ctrl.updateDefaultOpOptions()"
                               required
                               ng-model="opOption.value"
                               id="defaultOpOptionValue">
                    </md-input-container>
                    <div layout="column" layout-align="center">
                        <md-button class="md-icon-button md-primary"
                                   ng-click="ctrl.deleteOption(opOption)"
                                   aria-label="Delete operation option">
                            <md-icon class="md-secondary"
                                     md-svg-icon="delete"
                                     aria-label="delete operation option">
                            </md-icon>
                            <md-tooltip>Delete operation option</md-tooltip>
                        </md-button>

                    </div>
                </div>

                <md-button class="md-primary"
                           aria-label="add operation option"
                           ng-disabled="!ctrl.hasMoreOpOptions()"
                           ng-click="ctrl.addDefaultOperationOption()">
                    Add Operation Option
                </md-button>
            </div>

            <h4>Schema</h4>

            <div layout="row">
                <md-button class="md-primary"
                           aria-label="update schema"
                           ng-click="ctrl.updateSchema()">
                    Update schema
                </md-button>
            </div>
        </div>
    </div>
</div>
